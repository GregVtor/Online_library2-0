<!doctype html>
<html lang="en" style="height: 100%; min-width: 1000px">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <title>Онлаин Библиотека</title>
      <style>
        @import url('https://fonts.googleapis.com/css2?family=Oswald:wght@600&display=swap');
        :root {
          --yellow-100: #fff9c4;
        }
      </style>
  </head>
  <body style="height: 100%; background-color: #52a499;">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
    <div class="container-fluid" style="background: linear-gradient(#042c84, #52a499) no-repeat; height: 100%;">
      <div class="row" style="width: 100%;">
        <div class="col-3">
          <form class="row gy-1"  id="classes" action="/main" method="post">
            <div class="col-12"><br></div>
          </form>
          <br>
          <form action="/main" method="post">
            <input type="submit" name="out" value="Выход" class="btn btn-danger">
          </form>
          <a href="/books" class="btn btn-primary">Добавить книгу</a>
        </div>
        <div class="col-9">
          <table class="table table-striped" style="color: white">
            <thead>
              <tr>
                <th scope="col">#</th>
                <th scope="col">Название</th>
                <th scope="col">Автор</th>
                <th scope="col">Количество</th>
              </tr>
            </thead>
            <tbody id="tb">
              {% for c, i, j, n, id, mark, u in book %}
                <tr>
                  <th scope="row" style="color: white">{{ c }}</th>
                  <td style="color: white">{{ i }}</td>
                  <td style="color: white">{{ j }}</td>
                  <td style="color: white">{{ n }}</td>
                  {% if mark %}
                  <td>
                      <form action="/main" method="post">
                        <button type="submit" name="diz" value='{{id}} {{u}}'>Сдать</button>
                      </form>
                  </td>
                  {% endif %}
                </tr>
              {% endfor %}
            </tbody>
          </table>
          {% if mat %}
            <a class="btn btn-primary" href="/add_book">Выдать книгу</a>
          {% endif %}
        </div>
      </div>
    </div>
    <script>
        let xhr = new XMLHttpRequest();
        xhr.open("GET", "/db_req_classes");
        xhr.responseType = 'json'
        xhr.send()
        xhr.onload = function () {
            if (xhr.status === 200) {
                for (let i = 0; i < xhr.response.length; i++) {
                    let x = document.createElement('div');
                    x.className = 'col-12';
                    x.style.backgroundColor = 'white';
                    console.log(xhr.response[i][0]);
                    x.innerHTML = xhr.response[i][1];
                    x.style.border = '#202020 solid 1px';
                    x.style.borderRadius = '5px';
                    let id = xhr.response[i][0];
                    x.onclick = function delt (){
                        let xhr = new XMLHttpRequest();
                        xhr.open('POST', '/lib_data_class');
                        xhr.responseType = 'json'
                        xhr.setRequestHeader('Content-Type', 'application/json');
                        xhr.send(JSON.stringify({id: id}));
                        xhr.onload = function() {
                            console.log(xhr.response)
                        }
                    }
                    document.getElementById('classes').appendChild(x);
                }
            }
        }
    </script>
  </body>
</html>